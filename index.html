<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>서울 지하철 실시간 도착 정보</title>
</head>
<body>
  <h1>서울 지하철 실시간 도착 정보</h1>

  <select id="lineSelect">
    <option value="1호선">1호선</option>
    <option value="2호선">2호선</option>
    <option value="3호선">3호선</option>
  </select>

  <div id="result">데이터를 불러오는 중...</div>

  <script>
    const baseUrl = 'https://당신의-프록시-서버-주소/subway'; // Render 서버 주소로 변경하세요
    const result = document.getElementById('result');
    const select = document.getElementById('lineSelect');

    async function fetchSubway(line) {
      result.textContent = '불러오는 중...';
      try {
        const res = await fetch(`${baseUrl}?line=${encodeURIComponent(line)}`);
        if (!res.ok) throw new Error('서버 오류');
        const data = await res.json();
        if (!data.realtimePosition || !data.realtimePosition.row) {
          result.textContent = '데이터가 없습니다.';
          return;
        }
        result.innerHTML = data.realtimePosition.row.map(train => `
          <div>
            🚆 열차번호: ${train.trainNo}<br/>
            📍 현재역: ${train.statnNm}<br/>
            🔁 상태: ${train.trainSttus}<br/>
            🛤 방향: ${train.updnLine === '0' ? '상행' : '하행'}
          </div>
          <hr/>
        `).join('');
      } catch(e) {
        result.textContent = '에러: ' + e.message;
      }
    }

    select.addEventListener('change', () => fetchSubway(select.value));
    fetchSubway(select.value);
  </script>
</body>
</html>
