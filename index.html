<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ë„ì°© ì •ë³´</title>
</head>
<body>
  <h1>ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ë„ì°© ì •ë³´</h1>

  <select id="lineSelect">
    <option value="1í˜¸ì„ ">1í˜¸ì„ </option>
    <option value="2í˜¸ì„ ">2í˜¸ì„ </option>
    <option value="3í˜¸ì„ ">3í˜¸ì„ </option>
  </select>

  <div id="result">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

  <script>
    const baseUrl = 'https://ë‹¹ì‹ ì˜-í”„ë¡ì‹œ-ì„œë²„-ì£¼ì†Œ/subway'; // Render ì„œë²„ ì£¼ì†Œë¡œ ë³€ê²½í•˜ì„¸ìš”
    const result = document.getElementById('result');
    const select = document.getElementById('lineSelect');

    async function fetchSubway(line) {
      result.textContent = 'ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
      try {
        const res = await fetch(`${baseUrl}?line=${encodeURIComponent(line)}`);
        if (!res.ok) throw new Error('ì„œë²„ ì˜¤ë¥˜');
        const data = await res.json();
        if (!data.realtimePosition || !data.realtimePosition.row) {
          result.textContent = 'ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
          return;
        }
        result.innerHTML = data.realtimePosition.row.map(train => `
          <div>
            ğŸš† ì—´ì°¨ë²ˆí˜¸: ${train.trainNo}<br/>
            ğŸ“ í˜„ì¬ì—­: ${train.statnNm}<br/>
            ğŸ” ìƒíƒœ: ${train.trainSttus}<br/>
            ğŸ›¤ ë°©í–¥: ${train.updnLine === '0' ? 'ìƒí–‰' : 'í•˜í–‰'}
          </div>
          <hr/>
        `).join('');
      } catch(e) {
        result.textContent = 'ì—ëŸ¬: ' + e.message;
      }
    }

    select.addEventListener('change', () => fetchSubway(select.value));
    fetchSubway(select.value);
  </script>
</body>
</html>
