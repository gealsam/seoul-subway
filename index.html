<!-- index.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>서울 지하철 실시간 위치</title>
</head>
<body>
  <h1>서울 지하철 실시간 위치 (전체 노선)</h1>
  <div id="results">불러오는 중...</div>

  <script>
    const results = document.getElementById('results');

    async function fetchAllLines() {
      results.innerText = '불러오는 중...';
      try {
        const res = await fetch('/.netlify/functions/subway');
        if (!res.ok) {
          results.innerText = 'API 요청 실패: ' + res.statusText;
          return;
        }
        const data = await res.json();

        // data 구조: { "1": [...], "2": [...], ... }
        let html = '';
        for (const line in data) {
          html += `<h2>${line}호선</h2>`;
          if (!data[line].length) {
            html += `<p>데이터 없음</p>`;
            continue;
          }
          data[line].forEach(train => {
            html += `
              <div>
                🚆 열차번호: ${train.trainNo} <br/>
                📍 현재역: ${train.statnNm} <br/>
                🔁 상태: ${train.trainSttus} <br/>
                🛤 방향: ${train.updnLine === '0' ? '상행' : '하행'}
              </div><hr/>`;
          });
        }
        results.innerHTML = html;

      } catch (err) {
        results.innerText = '🚫 요청 실패: ' + err.message;
      }
    }

    fetchAllLines();
  </script>
</body>
</html>
