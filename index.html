<!-- index.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ìœ„ì¹˜</title>
</head>
<body>
  <h1>ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ìœ„ì¹˜ (ì „ì²´ ë…¸ì„ )</h1>
  <div id="results">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

  <script>
    const results = document.getElementById('results');

    async function fetchAllLines() {
      results.innerText = 'ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
      try {
        const res = await fetch('/.netlify/functions/subway');
        if (!res.ok) {
          results.innerText = 'API ìš”ì²­ ì‹¤íŒ¨: ' + res.statusText;
          return;
        }
        const data = await res.json();

        // data êµ¬ì¡°: { "1": [...], "2": [...], ... }
        let html = '';
        for (const line in data) {
          html += `<h2>${line}í˜¸ì„ </h2>`;
          if (!data[line].length) {
            html += `<p>ë°ì´í„° ì—†ìŒ</p>`;
            continue;
          }
          data[line].forEach(train => {
            html += `
              <div>
                ğŸš† ì—´ì°¨ë²ˆí˜¸: ${train.trainNo} <br/>
                ğŸ“ í˜„ì¬ì—­: ${train.statnNm} <br/>
                ğŸ” ìƒíƒœ: ${train.trainSttus} <br/>
                ğŸ›¤ ë°©í–¥: ${train.updnLine === '0' ? 'ìƒí–‰' : 'í•˜í–‰'}
              </div><hr/>`;
          });
        }
        results.innerHTML = html;

      } catch (err) {
        results.innerText = 'ğŸš« ìš”ì²­ ì‹¤íŒ¨: ' + err.message;
      }
    }

    fetchAllLines();
  </script>
</body>
</html>
